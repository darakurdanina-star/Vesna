<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–û–≥–æ—Ä–æ–¥: –ø–æ—Å–∞–¥–∏ –∏ —Å–æ–±–µ—Ä–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
            touch-action: none;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            background-color: #2c3e50;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* –ò–ì–†–û–í–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
        #game-container {
            position: relative;
            width: 100vw;
            height: 57.14vw; /* 768/1344 = 0.5714, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Ñ–æ–Ω–∞ */
            max-width: 1344px;
            max-height: 768px;
            background-color: #4CAF50;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin: auto;
        }

        /* –§–û–ù */
        .background-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('fon.png');
            background-size: cover;
            background-position: center;
            z-index: 1;
        }

        /* –ö–ê–†–¢–ê –ü–û–°–ê–î–ö–ò */
        .map-container {
            position: absolute;
            top: 2%;
            right: 2%;
            width: 20%;
            max-width: 180px;
            aspect-ratio: 1/1;
            border: 4px solid white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            z-index: 10;
            background: white;
            pointer-events: none;
        }

        .map-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* –õ–£–ù–ö–ò (–Ω–µ–≤–∏–¥–∏–º—ã–µ –∑–æ–Ω—ã) */
        .hole-zone {
            position: absolute;
            width: 10%;
            height: 10%;
            transform: translate(-50%, -50%);
            z-index: 5;
            /* border: 2px dashed red; /* –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ */
        }

        /* –°–ï–ú–ï–ù–ê –ò –û–í–û–©–ò - –û–î–ò–ù–ê–ö–û–í–´–ô –†–ê–ó–ú–ï–† */
        .seed, .vegetable {
            position: absolute;
            width: 6%;  /* –û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä */
            height: auto;
            cursor: grab;
            touch-action: none;
            user-select: none;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.3));
            z-index: 20;
            transition: filter 0.2s;
            pointer-events: auto;
        }

        .seed:active, .vegetable:active {
            cursor: grabbing;
            filter: drop-shadow(0 8px 6px rgba(0,0,0,0.5));
        }

        .seed.dragging, .vegetable.dragging {
            transition: none;
        }

        .seed.placed, .vegetable.placed {
            cursor: default;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
            pointer-events: none;
        }

        /* –°–¢–ê–†–¢–û–í–´–ï –ü–û–ó–ò–¶–ò–ò –°–ï–ú–Ø–ù (–ù–ê–í–ï–†–•–£) */
        #seed-red { left: 5%; top: 5%; }
        #seed-orange { left: 15%; top: 5%; }
        #seed-brown { left: 25%; top: 5%; }
        #seed-purple { left: 35%; top: 5%; }
        #seed-beige { left: 45%; top: 5%; }
        #seed-green { left: 55%; top: 5%; }

        /* –ö–û–†–ó–ò–ù–ö–ò (–Ω–∞ –≤—Ç–æ—Ä–æ–º —ç–∫—Ä–∞–Ω–µ) */
        .basket {
            position: absolute;
            width: 6%;  /* –û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Å —Å–µ–º–µ–Ω–∞–º–∏ */
            height: auto;
            z-index: 15;
            pointer-events: none;
        }

        /* –ü–û–ó–ò–¶–ò–ò –ö–û–†–ó–ò–ù–û–ö (–Ω–∞–≤–µ—Ä—Ö—É) */
        #basket-red { left: 5%; top: 5%; }      /* –¥–ª—è —Ç–æ–º–∞—Ç–∞ */
        #basket-orange { left: 15%; top: 5%; }  /* –¥–ª—è –º–æ—Ä–∫–æ–≤–∏ */
        #basket-brown { left: 25%; top: 5%; }   /* –¥–ª—è –∫–∞—Ä—Ç–æ—à–∫–∏ */
        #basket-purple { left: 35%; top: 5%; }  /* –¥–ª—è –±—É—Ä–∞–∫–∞ */
        #basket-beige { left: 45%; top: 5%; }   /* –¥–ª—è –ª—É–∫–∞ */
        #basket-green { left: 55%; top: 5%; }   /* –¥–ª—è –æ–≥—É—Ä—Ü–∞ */

        /* –û–í–û–©–ò –ù–ê –ì–†–Ø–î–ö–ï (–≤—Ç–æ—Ä–æ–π —ç–∫—Ä–∞–Ω) */
        .vegetable {
            cursor: grab;
        }

        /* –≠–ö–†–ê–ù–´ */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        #screen-plant {
            display: block;
        }

        #screen-harvest {
            display: none;
        }

        /* –ö–ù–û–ü–ö–ê –ü–ï–†–ï–•–û–î–ê */
        .next-button {
            position: absolute;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 30px;
            font-size: 24px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 0 #2E7D32;
            font-weight: bold;
            z-index: 30;
        }

        .next-button:active {
            transform: translateX(-50%) translateY(4px);
            box-shadow: 0 1px 0 #2E7D32;
        }

        .next-button.hidden {
            display: none;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        /* –ü–û–ë–ï–î–ê */
        #win-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 100;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .win-img {
            width: min(300px, 50%);
            border: 5px solid white;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .win-button {
            padding: 15px 40px;
            font-size: 28px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #2E7D32;
        }

        .win-button:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #2E7D32;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <!-- –§–û–ù (–æ–¥–∏–Ω –¥–ª—è –æ–±–æ–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤) -->
        <div class="background-layer"></div>

        <!-- ========== –≠–ö–†–ê–ù 1: –ü–û–°–ê–î–ö–ê ========== -->
        <div id="screen-plant" class="screen">
            <!-- –ö–ê–†–¢–ê –ü–û–°–ê–î–ö–ò -->
            <div class="map-container">
                <img src="map.png" alt="–ö–∞—Ä—Ç–∞ –ø–æ—Å–∞–¥–∫–∏" class="map-img">
            </div>

            <!-- –õ–£–ù–ö–ò -->
            <div class="hole-zone" id="hole-1" style="left: 27%; top: 83.3%;" data-seed="red" data-screen="plant"></div>
            <div class="hole-zone" id="hole-2" style="left: 48.5%; top: 83.3%;" data-seed="brown" data-screen="plant"></div>
            <div class="hole-zone" id="hole-3" style="left: 68.8%; top: 83.3%;" data-seed="beige" data-screen="plant"></div>
            <div class="hole-zone" id="hole-4" style="left: 34.8%; top: 66.8%;" data-seed="orange" data-screen="plant"></div>
            <div class="hole-zone" id="hole-5" style="left: 48.5%; top: 66.8%;" data-seed="purple" data-screen="plant"></div>
            <div class="hole-zone" id="hole-6" style="left: 62.2%; top: 66.8%;" data-seed="green" data-screen="plant"></div>

            <!-- –°–ï–ú–ï–ù–ê (–ù–ê–í–ï–†–•–£) -->
            <img src="red.png" class="seed" id="seed-red" data-color="red" data-screen="plant">
            <img src="orange.png" class="seed" id="seed-orange" data-color="orange" data-screen="plant">
            <img src="brown.png" class="seed" id="seed-brown" data-color="brown" data-screen="plant">
            <img src="purple.png" class="seed" id="seed-purple" data-color="purple" data-screen="plant">
            <img src="beige.png" class="seed" id="seed-beige" data-color="beige" data-screen="plant">
            <img src="green.png" class="seed" id="seed-green" data-color="green" data-screen="plant">

            <!-- –ö–ù–û–ü–ö–ê –ü–ï–†–ï–•–û–î–ê (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ—Å–∞–¥–∫–∏) -->
            <button class="next-button hidden" id="to-harvest-btn" onclick="switchToHarvest()">üå± –ù–ê –°–ë–û–† –£–†–û–ñ–ê–Ø üå±</button>
        </div>

        <!-- ========== –≠–ö–†–ê–ù 2: –°–ë–û–† –£–†–û–ñ–ê–Ø ========== -->
        <div id="screen-harvest" class="screen">
            <!-- –ö–û–†–ó–ò–ù–ö–ò (–ù–ê–í–ï–†–•–£) -->
            <img src="red1.png" class="basket" id="basket-red" data-color="red">
            <img src="orange1.png" class="basket" id="basket-orange" data-color="orange">
            <img src="brown1.png" class="basket" id="basket-brown" data-color="brown">
            <img src="purple1.png" class="basket" id="basket-purple" data-color="purple">
            <img src="beige1.png" class="basket" id="basket-beige" data-color="beige">
            <img src="green1.png" class="basket" id="basket-green" data-color="green">

            <!-- –õ–£–ù–ö–ò –î–õ–Ø –û–í–û–©–ï–ô -->
            <div class="hole-zone" id="hole-1-harvest" style="left: 27%; top: 83.3%;" data-vegetable="tomato" data-screen="harvest"></div>
            <div class="hole-zone" id="hole-2-harvest" style="left: 48.5%; top: 83.3%;" data-vegetable="potato" data-screen="harvest"></div>
            <div class="hole-zone" id="hole-3-harvest" style="left: 68.8%; top: 83.3%;" data-vegetable="luk" data-screen="harvest"></div>
            <div class="hole-zone" id="hole-4-harvest" style="left: 34.8%; top: 66.8%;" data-vegetable="carrot" data-screen="harvest"></div>
            <div class="hole-zone" id="hole-5-harvest" style="left: 48.5%; top: 66.8%;" data-vegetable="buk" data-screen="harvest"></div>
            <div class="hole-zone" id="hole-6-harvest" style="left: 62.2%; top: 66.8%;" data-vegetable="ogr" data-screen="harvest"></div>

            <!-- –û–í–û–©–ò (–í –õ–£–ù–ö–ê–•) -->
            <img src="tomato.png" class="vegetable" id="veg-tomato" data-vegetable="tomato" data-color="red" style="left: 27%; top: 83.3%; transform: translate(-50%, -50%);">
            <img src="potato.png" class="vegetable" id="veg-potato" data-vegetable="potato" data-color="brown" style="left: 48.5%; top: 83.3%; transform: translate(-50%, -50%);">
            <img src="luk.png" class="vegetable" id="veg-luk" data-vegetable="luk" data-color="beige" style="left: 68.8%; top: 83.3%; transform: translate(-50%, -50%);">
            <img src="carrot.png" class="vegetable" id="veg-carrot" data-vegetable="carrot" data-color="orange" style="left: 34.8%; top: 66.8%; transform: translate(-50%, -50%);">
            <img src="buk.png" class="vegetable" id="veg-buk" data-vegetable="buk" data-color="purple" style="left: 48.5%; top: 66.8%; transform: translate(-50%, -50%);">
            <img src="ogr.png" class="vegetable" id="veg-ogr" data-vegetable="ogr" data-color="green" style="left: 62.2%; top: 66.8%; transform: translate(-50%, -50%);">
        </div>

        <!-- –≠–ö–†–ê–ù –ü–û–ë–ï–î–´ -->
        <div id="win-screen">
            <img src="win.png" alt="–ü–æ–±–µ–¥–∞!" class="win-img">
            <button class="win-button" onclick="playAgain()">üéÆ –ò–ì–†–ê–¢–¨ –ï–©–Å üéÆ</button>
        </div>
    </div>

    <script>
        // ========== –û–ë–©–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        const container = document.getElementById('game-container');
        const screenPlant = document.getElementById('screen-plant');
        const screenHarvest = document.getElementById('screen-harvest');
        const winScreen = document.getElementById('win-screen');
        const toHarvestBtn = document.getElementById('to-harvest-btn');

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let isDragging = false;
        let currentElement = null;
        let startX, startY, startLeft, startTop;
        let audioContext = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—É–∫–∞
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }

        function playSound(type) {
            try {
                initAudio();
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);

                if (type === 'correct') {
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(600, audioContext.currentTime);
                    gain.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    osc.start();
                    osc.stop(audioContext.currentTime + 0.2);
                } else {
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(200, audioContext.currentTime);
                    gain.gain.setValueAtTime(0.15, audioContext.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    osc.start();
                    osc.stop(audioContext.currentTime + 0.15);
                }
            } catch (e) {}
        }

        // ========== –ü–ï–†–ï–¢–ê–°–ö–ò–í–ê–ù–ò–ï ==========
        
        function onDragStart(e) {
            const element = e.target;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å
            if (!element.classList.contains('seed') && !element.classList.contains('vegetable')) return;
            if (element.classList.contains('placed')) return;
            if (winScreen.style.display === 'flex') return;
            
            e.preventDefault();
            initAudio();
            
            currentElement = element;
            isDragging = true;
            currentElement.classList.add('dragging');
            
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            
            const rect = currentElement.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            startX = clientX - rect.left;
            startY = clientY - rect.top;
            
            startLeft = rect.left - containerRect.left;
            startTop = rect.top - containerRect.top;
            
            currentElement.style.left = startLeft + 'px';
            currentElement.style.top = startTop + 'px';
        }

        function onDragMove(e) {
            if (!isDragging || !currentElement) return;
            e.preventDefault();
            
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            
            const containerRect = container.getBoundingClientRect();
            
            let newLeft = clientX - startX - containerRect.left;
            let newTop = clientY - startY - containerRect.top;
            
            const elementWidth = currentElement.offsetWidth;
            const elementHeight = currentElement.offsetHeight;
            
            newLeft = Math.max(0, Math.min(newLeft, containerRect.width - elementWidth));
            newTop = Math.max(0, Math.min(newTop, containerRect.height - elementHeight));
            
            currentElement.style.left = newLeft + 'px';
            currentElement.style.top = newTop + 'px';
        }

        function onDragEnd(e) {
            if (!isDragging || !currentElement) return;
            e.preventDefault();
            
            isDragging = false;
            currentElement.classList.remove('dragging');
            
            checkDrop(currentElement);
            currentElement = null;
        }

        // ========== –ü–†–û–í–ï–†–ö–ê –î–õ–Ø –ü–û–°–ê–î–ö–ò ==========
        
        function checkDrop(element) {
            const elementRect = element.getBoundingClientRect();
            const elementCenterX = elementRect.left + elementRect.width / 2;
            const elementCenterY = elementRect.top + elementRect.height / 2;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–π —Å–µ–π—á–∞—Å —ç–∫—Ä–∞–Ω
            const currentScreen = element.closest('.screen').id;
            
            if (currentScreen === 'screen-plant') {
                // –≠–ö–†–ê–ù –ü–û–°–ê–î–ö–ò
                const seedColor = element.dataset.color;
                const holes = document.querySelectorAll('#screen-plant .hole-zone');
                
                for (let i = 0; i < holes.length; i++) {
                    const hole = holes[i];
                    const holeRect = hole.getBoundingClientRect();
                    
                    if (elementCenterX >= holeRect.left && elementCenterX <= holeRect.right &&
                        elementCenterY >= holeRect.top && elementCenterY <= holeRect.bottom) {
                        
                        const requiredColor = hole.dataset.seed;
                        
                        if (seedColor === requiredColor && !element.classList.contains('placed')) {
                            // –ü—Ä–∞–≤–∏–ª—å–Ω–æ
                            plantSeed(element, hole, i);
                            playSound('correct');
                        } else {
                            // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
                            playSound('error');
                            returnToStart(element);
                            container.classList.add('shake');
                            setTimeout(() => container.classList.remove('shake'), 400);
                        }
                        return;
                    }
                }
                
                // –ù–µ –ø–æ–ø–∞–ª –≤ –ª—É–Ω–∫—É
                returnToStart(element);
                
            } else if (currentScreen === 'screen-harvest') {
                // –≠–ö–†–ê–ù –°–ë–û–†–ê
                const vegetableType = element.dataset.vegetable;
                const vegetableColor = element.dataset.color;
                const baskets = document.querySelectorAll('#screen-harvest .basket');
                
                for (let i = 0; i < baskets.length; i++) {
                    const basket = baskets[i];
                    const basketRect = basket.getBoundingClientRect();
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–æ–Ω—É –∫–æ—Ä–∑–∏–Ω–∫–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
                    const expandedRect = {
                        left: basketRect.left - 20,
                        right: basketRect.right + 20,
                        top: basketRect.top - 20,
                        bottom: basketRect.bottom + 20
                    };
                    
                    if (elementCenterX >= expandedRect.left && elementCenterX <= expandedRect.right &&
                        elementCenterY >= expandedRect.top && elementCenterY <= expandedRect.bottom) {
                        
                        const basketColor = basket.dataset.color;
                        
                        if (vegetableColor === basketColor && !element.classList.contains('placed')) {
                            // –ü—Ä–∞–≤–∏–ª—å–Ω–æ
                            harvestVegetable(element, basket, i);
                            playSound('correct');
                        } else {
                            // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
                            playSound('error');
                            returnVegetableToStart(element);
                            container.classList.add('shake');
                            setTimeout(() => container.classList.remove('shake'), 400);
                        }
                        return;
                    }
                }
                
                // –ù–µ –ø–æ–ø–∞–ª –≤ –∫–æ—Ä–∑–∏–Ω–∫—É
                returnVegetableToStart(element);
            }
        }

        // ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ü–û–°–ê–î–ö–ò ==========
        
        function plantSeed(seed, hole, holeIndex) {
            seed.classList.add('placed');
            
            const holeRect = hole.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            const targetLeft = holeRect.left - containerRect.left + (holeRect.width / 2) - (seed.offsetWidth / 2);
            const targetTop = holeRect.top - containerRect.top + (holeRect.height / 2) - (seed.offsetHeight / 2);
            
            seed.style.left = targetLeft + 'px';
            seed.style.top = targetTop + 'px';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ —Å–µ–º–µ–Ω–∞ –ø–æ—Å–∞–∂–µ–Ω—ã
            checkAllPlanted();
        }

        function returnToStart(seed) {
            switch(seed.dataset.color) {
                case 'red': seed.style.left = '5%'; seed.style.top = '5%'; break;
                case 'orange': seed.style.left = '15%'; seed.style.top = '5%'; break;
                case 'brown': seed.style.left = '25%'; seed.style.top = '5%'; break;
                case 'purple': seed.style.left = '35%'; seed.style.top = '5%'; break;
                case 'beige': seed.style.left = '45%'; seed.style.top = '5%'; break;
                case 'green': seed.style.left = '55%'; seed.style.top = '5%'; break;
            }
        }

        function checkAllPlanted() {
            const seeds = document.querySelectorAll('#screen-plant .seed');
            const allPlanted = Array.from(seeds).every(seed => seed.classList.contains('placed'));
            
            if (allPlanted) {
                toHarvestBtn.classList.remove('hidden');
            }
        }

        // ========== –ü–ï–†–ï–•–û–î –ù–ê –í–¢–û–†–û–ô –≠–ö–†–ê–ù ==========
        
        function switchToHarvest() {
            screenPlant.style.display = 'none';
            screenHarvest.style.display = 'block';
        }

        // ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–ë–û–†–ê ==========
        
        function harvestVegetable(vegetable, basket, basketIndex) {
            vegetable.classList.add('placed');
            
            const basketRect = basket.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            const targetLeft = basketRect.left - containerRect.left + (basketRect.width / 2) - (vegetable.offsetWidth / 2);
            const targetTop = basketRect.top - containerRect.top + (basketRect.height / 2) - (vegetable.offsetHeight / 2);
            
            vegetable.style.left = targetLeft + 'px';
            vegetable.style.top = targetTop + 'px';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –æ–≤–æ—â–∏ —Å–æ–±—Ä–∞–Ω—ã
            checkAllHarvested();
        }

        function returnVegetableToStart(vegetable) {
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –∏—Å—Ö–æ–¥–Ω—É—é –ª—É–Ω–∫—É
            switch(vegetable.dataset.vegetable) {
                case 'tomato':
                    vegetable.style.left = '27%';
                    vegetable.style.top = '83.3%';
                    break;
                case 'potato':
                    vegetable.style.left = '48.5%';
                    vegetable.style.top = '83.3%';
                    break;
                case 'luk':
                    vegetable.style.left = '68.8%';
                    vegetable.style.top = '83.3%';
                    break;
                case 'carrot':
                    vegetable.style.left = '34.8%';
                    vegetable.style.top = '66.8%';
                    break;
                case 'buk':
                    vegetable.style.left = '48.5%';
                    vegetable.style.top = '66.8%';
                    break;
                case 'ogr':
                    vegetable.style.left = '62.2%';
                    vegetable.style.top = '66.8%';
                    break;
            }
            vegetable.style.transform = 'translate(-50%, -50%)';
        }

        function checkAllHarvested() {
            const vegetables = document.querySelectorAll('#screen-harvest .vegetable');
            const allHarvested = Array.from(vegetables).every(veg => veg.classList.contains('placed'));
            
            if (allHarvested) {
                setTimeout(() => {
                    winScreen.style.display = 'flex';
                }, 500);
            }
        }

        // ========== –ò–ì–†–ê–¢–¨ –°–ù–û–í–ê ==========
        
        function playAgain() {
            winScreen.style.display = 'none';
            screenHarvest.style.display = 'none';
            screenPlant.style.display = 'block';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–º–µ–Ω–∞
            const seeds = document.querySelectorAll('#screen-plant .seed');
            seeds.forEach(seed => {
                seed.classList.remove('placed');
                returnToStart(seed);
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –æ–≤–æ—â–∏
            const vegetables = document.querySelectorAll('#screen-harvest .vegetable');
            vegetables.forEach(veg => {
                veg.classList.remove('placed');
                returnVegetableToStart(veg);
            });
            
            toHarvestBtn.classList.add('hidden');
        }

        // ========== –ù–ê–ó–ù–ê–ß–ê–ï–ú –°–û–ë–´–¢–ò–Ø ==========
        
        // –°–ª—É—à–∞–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ –≤—Å–µ—Ö –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö
        document.querySelectorAll('.seed, .vegetable').forEach(element => {
            element.addEventListener('mousedown', onDragStart);
            element.addEventListener('touchstart', onDragStart, { passive: false });
        });

        window.addEventListener('mousemove', onDragMove);
        window.addEventListener('touchmove', onDragMove, { passive: false });

        window.addEventListener('mouseup', onDragEnd);
        window.addEventListener('touchend', onDragEnd);

        // –ó–∞–ø—Ä–µ—â–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
        document.addEventListener('selectstart', (e) => e.preventDefault());

        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏
        window.switchToHarvest = switchToHarvest;
        window.playAgain = playAgain;

    </script>
</body>
</html>

